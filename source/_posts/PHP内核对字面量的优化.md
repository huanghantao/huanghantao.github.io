---
title: PHP内核对字面量的优化
date: 2020-11-05 22:35:49
tags:
- PHP
- PHP内核
---

前几天，我发现`PHP`内核在处理字面量的时候是比较简单粗暴的，编译出一个常量，就直接把它放到`literals`里面了。那么这就会导致同一个常量会被存储多份，这显然是没有必要的。然后我对这部分代码优化好几个小时后发现，`opcache`已经对这个进行了优化，在函数`zend_optimizer_compact_literals`里面，会对等价的字面量进行合并。
