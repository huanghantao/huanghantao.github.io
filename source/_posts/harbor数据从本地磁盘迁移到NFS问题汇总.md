---
title: harbor数据从本地磁盘迁移到NFS问题汇总
date: 2022-04-11 14:33:13
tags:
- harbor
---

开始`harbor`的数据是放在本地磁盘的，然后满了，想要挂到`NFS`里面。

本以为拷贝到`NFS`里面就可以直接运行了。但是，发现有几个容器起不来。通过查看日志发现，是因为一些目录没拷贝过来，以及目录的权限有问题导致的。

因为我们的`harbor`是通过`docker`容器运行的，所以，它生成的数据目录`owner`不都是`root`（`harbor`的启动方式要求是`root`权限）。所以，在拷贝的时候，要注意保留原来的目录`owner`和权限才行。然后没拷贝完整的目录都再单独拷贝一下即可。

> 总之，迁移harbor数据的问题不要慌，先把没迁移数据前的启动日志记录了下来，然后再和迁移后的启动日志对比一下，就可以开始排查问题了。
